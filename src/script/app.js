(()=>{"use strict";const e=async(e,t,n)=>{const s={method:t,headers:{"Content-Type":"application/json"},credentials:"include"};n&&(s.body=JSON.stringify(n));try{const t=await fetch(`https://naturist.herokuapp.com${e}`,s);return await t.json()}catch(e){console.log(e)}};class t{constructor(){this.tourContainer=document.querySelector(".tour-container")}generateMarkup(e){const t=`<div class="tour">\n    <div class="tour-stars">\n      <i class="far fa-star"></i>\n      <i class="far fa-star"></i>\n      <i class="far fa-star"></i>\n      <i class="far fa-star"></i>\n      <i class="far fa-star"></i>\n    </div>\n    <div class="tour-img">\n      <img src="./src/img/img.jpg" alt="">\n      <span class="img-linear-bg"></span>\n      <p class="tour-title">${e.name}</p>\n    </div>\n    <div class="tour-details">\n      <ul class="detail-list">\n        <li class="tour-detail-list-item">\n          <i class="far fa-flag"></i>\n        <p>${e.location}</p>\n        </li>\n        <li class="tour-detail-list-item">\n          <i class="far fa-user"></i>\n          <p>${e.groupSize}</p>\n        </li>\n        <li class="tour-detail-list-item">\n          <i class="far fa-clock"></i>\n          <p>${e.tourLength}</p>\n        </li>\n        <li class="tour-detail-list-item">\n          <i class="far fa-calendar-alt"></i>\n          <p>${new Date(e.dates[0]).getFullYear()}</p>\n        </li>\n      </ul>\n    </div>\n      <div class="tour-bottom-details">\n        <div class="tour-price">\n          <span>Only</span>\n          <p>$${e.price}</p>\n        </div>\n        <a href="#" class="tour-detail-btn">Details</a>\n      </div>\n  </div>`;this.tourContainer.insertAdjacentHTML("afterbegin",t)}}const n=new class{constructor(){this.loginBtn=document.querySelector(".login-btn")}getLoginInputs(){return{email:document.getElementById("email").value,password:document.getElementById("password").value}}updateUI(){const e=document.querySelector(".login-btn-text"),t=document.querySelector(".loader");e.classList.add("hidden"),t.classList.remove("hidden")}defaultUI(){const e=document.querySelector(".login-btn-text"),t=document.querySelector(".loader");e.classList.remove("hidden"),t.classList.add("hidden")}},s=new class{constructor(){this.navBarList=document.querySelector(".list")}updateUI(e){const t=document.querySelector(".user-not-loggedin"),n=document.querySelector(".user-loggedin");document.querySelector(".user-name").innerText=`Welcome, ${e.data.user.name.split(" ")[0]}`,t.classList.add("hidden"),n.classList.remove("hidden")}defaultUI(){const e=document.querySelector(".user-not-loggedin"),t=document.querySelector(".user-loggedin");e.classList.remove("hidden"),t.classList.add("hidden")}getlogoutBtn(){const e=document.querySelector(".logout-btn");if(e)return e}},a=new class{constructor(){this.bg=document.querySelector(".bg")}showSpinner(){this.bg.classList.remove("hidden")}hideSpinner(){this.bg.classList.add("hidden")}},o=new class{constructor(){this.signupbtn=document.querySelector(".signup-btn")}getInputs(){return{email:document.getElementById("email").value,password:document.getElementById("password").value,confirmPassword:document.getElementById("confirm-password").value,name:document.getElementById("name").value}}resetInput(){document.getElementById("password").value="",document.getElementById("confirm-password").value=""}updateUI(){const e=document.querySelector(".signup-btn-text"),t=document.querySelector(".loader");e.classList.add("hidden"),t.classList.remove("hidden")}defaultUI(){const e=document.querySelector(".signup-btn-text"),t=document.querySelector(".loader");e.classList.remove("hidden"),t.classList.add("hidden")}},i=new class{constructor(){}showPopup(e){const t=document.querySelector(".popup");t.textContent=e,t.style.display="block",t.style.opacity="1"}hidePopup(){const e=document.querySelector(".popup");e.style.display="none",e.style.opacity="0"}},c=async()=>{try{const t=n.getLoginInputs();n.updateUI(),"Fail"===(await e("/api/user/login","POST",t)).status&&n.defaultUI(),n.defaultUI(),window.location.href="/"}catch(e){console.log(e)}},l=async()=>{console.log("logging out");try{a.showSpinner(),await e("/api/user/logout","GET"),s.defaultUI(),window.location.href="/",a.hideSpinner()}catch(e){console.log(e)}},r=async()=>{o.updateUI();const t=o.getInputs(),n=await e("/api/user/signup","POST",t);n.data?i.showPopup(n.data.message):i.showPopup(n.message),o.resetInput(),setTimeout((()=>{i.hidePopup()}),3e3),o.defaultUI()};(async()=>{try{if("/activate-account.html"===window.location.pathname){const t=window.location.search.split("=")[1],n=await e(`/api/user/activate-account?verify=${t}`,"GET");"success"===n.status?window.location.href="/login.html":document.write(n.message)}else a.showSpinner();n.loginBtn&&n.loginBtn.addEventListener("click",c),await(async()=>{try{const t=await e("/api/user/about-me","GET");"success"===t.status&&(s.updateUI(t),a.hideSpinner()),a.hideSpinner()}catch(e){console.log(e)}})(),"/tours.html"==window.location.pathname&&await(async()=>{const n=await e("/api/tour","GET"),s=new t;n.data.tours.forEach((e=>{s.generateMarkup(e)}))})(),s.getlogoutBtn()&&s.getlogoutBtn().addEventListener("click",l),"/signup.html"==window.location.pathname&&o.signupbtn.addEventListener("click",r)}catch(e){console.log(e)}})()})();